# 二叉树概率题

**题目：给定一个满完全二叉树，并且每个节点有parent指针，每个节点的值为0/1，每个parent节点的值都是两个child节点的“AND"结果，现在把一个leaf随机翻牌子（0变1或者1变0），这时候自然需要向上更新，整个过程时间复杂度的期望值是多少？**

**解答：**

leaf node 区分左右的话，可能有4种组合，每种组合分别有 flip{left, right} 两种选择，于是：

* 0,0 - 左，变成1； 右，变成1
* 0,1 - 左，不变； 右，变成0
* 1,0 - 左，变成0；右，不变；
* 1,1 - 左，不变，右，不变；

总共会造成 parent node 的值和之前有变化的可能是 4 种，所以在**每一层 parent - child 的关系中任意 flip 一个 child，有 1/2 的几率造成 parent 的值也被 flip.**

假设二叉树中总共有 N 的节点，其深度/自底向上路径长是 h = O\(logN\)，那我们自底向上的更新路径实际次数就会在 【1, h】 的闭区间内，如果每次都更新到root，那么时间复杂度是O\(logN\)，但是必然不会每次更新到root

最开始至少更新一个leaf，是1次

有1/2的概率对parent有影响，计算期望需要多加1次，1 x 1/2

所以期望就是 1 + 1 x 1/2 + 1 x 1/4 + 1 x 1/8 ... = 2

所以时间复杂度是O\(1\)

